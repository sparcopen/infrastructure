{% assign thread = page.permalink | remove: "/" %}

{% if page.name contains "report-" %}
{% assign thread_type = "categories" %}
{% else %}
{% assign thread_type = "tags" %}
{% endif %}

{% if page.name == "latest.html" %}
{% assign posts = site.posts %}
{% elsif page.reversed %}
{% assign posts = site.[thread_type].[thread] | reverse %}
{% else %}
{% assign posts = site.[thread_type].[thread] %}
{% endif %}

{% for post in posts limit:1 %}
<!-- Featured / latest post -->
<li class="toc__featured">
  {% if thread_type == "tags" and post.category %}
  <p class="label">
    From the <a href="/{{ post.category }}">{{ post.category | replace: '-',' ' | upcase }}</a> report
  </p>
  {% endif %}
  <div class="row">
    <h4 class="col col--2of3 col--group">
      <a href="{{ post.permalink }}" class="toc__link">
        {{ post.title }}
      </a>
    </h4>
    <p class="col col--1of3 col--group metadata">
      {% include post-readtime.html %}
    </p>
  </div>
  <p class="col col--5of6 col--group toc__featured-desc">
    {{ post.description }}
  </p>
</li>
{% endfor %}

<!-- Rest of ToC -->
{% for post in posts offset:2 %}
<li class="row toc__item">
  <div class="col col--group col--1of3">
    <h4>
      <a href="{{ post.permalink }}" class="toc__link">
        {{ post.title }}
      </a>
    </h4>
    <p class="metadata">
      {% include post-readtime.html %}
    </p>
  </div>
  <div class="col col--group col--2of3">
    <p>{{ post.description }}</p>
    {% if thread_type == "tags" and post.category %}
    <p class="metadata">From the <a href="/{{ post.category }}">{{ post.category | replace: '-',' ' | upcase }}</a> report</p>
    {% endif %}
  </div>
</li>
{% endfor  %}
